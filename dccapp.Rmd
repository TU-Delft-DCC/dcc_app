---
title: "DCC Reporting Dashboard"
output:
  flexdashboard::flex_dashboard:
    theme:
      version: 4
      bootswatch: lux
    css: custom.css
    orientation: rows
    social: menu
    source_code: "https://github.com/TU-Delft-DCC/dcc_app"
runtime: shiny
---


```{r setup, include=FALSE}
# Package names
packages <- c("flexdashboard", "remotes", "googlesheets4", "plotly")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))

remotes::install_github("rstudio/bslib")

# documentation for flexdashboard options: https://rstudio.github.io/flexdashboard/articles/using.html 

options(gargle_oauth_email = "acryan@g-tudelft.nl")

```

```{r}
df <- read_sheet("https://docs.google.com/spreadsheets/d/1pEdWUvcnKMdp0KD5XpEhleFqA7hAbDm6VxagN0yTqMU/edit?usp=sharing")
```

# Sidebar {.sidebar}

### Projects by the DCC

This is a reporting dashboard for projects completed by the Digital Competence Centre (DCC) at TU Delft. For further information and to find out more about how the DCC can support your FAIR research data and software needs, please visit dcc.tudelft.nl. 

```{r}
# select faculty using checkbox?


```

# Dashboard

## Row

### Requests processed {.value-box}

```{r}
renderValueBox({
  requests <- nrow(df)
  valueBox(
    value = requests,
    icon = "fa-list",
    color = "primary"
    )
  })
```

### Projects completed {.value-box}

```{r}
renderValueBox({
  completed <- sum(df$status == "Completed")
  valueBox(
    value = completed,
    icon = "fa-thumbs-up",
    color = "secondary"
  )
})
```

### Projects running {.value-box}

```{r}
renderValueBox({
  running <- sum(df$status == "Running")
  valueBox(
    value = running,
    icon = "fa-spinner",
    color = "success"
  )
})
```

## Row

### Hours assigned {.value-box}

```{r}
renderValueBox({
  assigned <- sum(df$hours_assigned, na.rm = TRUE)
  valueBox(
    value = assigned,
    icon = "fa-clock",
    color = "info"
  )
})
```

### Team members {.value-box}

```{r}
renderValueBox({
  team <- 8 #static number
  valueBox(
    value = team,
    icon = "fa-user",
    color = "warning"
  )
})
```

### Number of applicants {.value-box}

```{r}
renderValueBox({
  applicants <- length(unique(df[["applicant_id"]]))
  valueBox(
    value = applicants,
    icon = "fa-user-plus",
    color = "danger"
  )
})
```

## Row

### Projects by faculty {data-width=700"}

```{r}

p <- ggplot(data = df, aes(x = faculty, y = hours_assigned), fill = faculty) +
  geom_bar(stat="identity")

ggplotly(p)

```

# Project descriptions

